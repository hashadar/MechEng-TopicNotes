%data collection
clc
clear
close all

meshConvergence.s40 = [0	0
0.00123331	82.7526
0.00154137	103.423
0.00242298	122.025
0.00289453	122.942
0.00358152	123.966
0.00457971	125.115
0.00617	126.241
0.00873668	127.387
0.0132537	128.447
0.015279	128.719
0.016187	128.836
0.0165548	128.877
0.0177882	128.594
0.0190262	128.318
0.0203109	128.029
0.0216236	127.734
0.0236216	127.282
0.0267326	126.574
0.0316554	125.441
0.0397609	123.54
0.0534119	120.232
0.0766698	114.245
0.124667	99.639
0.137402	95.3339
0.150751	90.589
0.170789	83.1311
0.200629	71.2888
0.244653	52.1432
0.26088	44.5504
0.266937	41.6369
0.275976	37.2014
0.289405	30.4146
0.309218	19.8231
0.338118	3.59307
0.377455	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0];

n = numel(meshConvergence.s40(:,2));
maxStress.s40 = 0;
for i = 1:n
    if maxStress.s40 < meshConvergence.s40(i,2)
        maxStress.s40 = meshConvergence.s40(i,2);
    end
end

meshConvergence.s20 = [0	0
0.00122874	82.3581
0.00153558	102.924
0.00244206	122.075
0.00295585	123.051
0.00367452	124.072
0.00476903	125.265
0.00647775	126.418
0.00918178	127.537
0.0139639	128.542
0.0160014	128.815
0.0205997	127.698
0.0255709	126.492
0.0309992	125.156
0.0400789	122.874
0.0548655	119.023
0.0704744	114.769
0.0873587	109.926
0.117786	100.364
0.129844	96.3048
0.149423	89.2741
0.180846	76.8949
0.192677	71.9433
0.210524	64.1559
0.237174	51.8369
0.276479	32.1517
0.33385	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
];

n = numel(meshConvergence.s20(:,2));
maxStress.s20 = 0;
for i = 1:n
    if maxStress.s20 < meshConvergence.s20(i,2)
        maxStress.s20 = meshConvergence.s20(i,2);
    end
end

meshConvergence.s10 = [0	0
0.00122413	81.9807
0.00152979	102.451
0.00248311	122.176
0.00285954	122.864
0.00317889	123.383
0.00370494	124.105
0.00445984	124.985
0.0057313	125.937
0.0074115	126.878
0.010132	127.869
0.015046	128.687
0.0154377	128.74
0.0157847	128.787
0.0161011	128.826
0.0165902	128.88
0.0167742	128.901
0.0168516	128.909
0.0170527	128.86
0.0177335	128.7
0.0178013	128.684
0.0179424	128.651
0.0182191	128.586
0.0187752	128.455
0.0199508	128.176
0.0217731	127.743
0.0245948	127.069
0.0293202	125.928
0.0373119	123.964
0.049835	120.8
0.0696215	115.586
0.102663	106.227
0.115579	102.346
0.138007	95.2123
0.183285	78.8179
0.194838	74.2906
0.206962	69.3396
0.225911	61.1715
0.255281	47.5013
0.300092	24.4181
0.316856	15.0258
0.342405	0.182397
0.351074	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0];

n = numel(meshConvergence.s10(:,2));
maxStress.s10 = 0;
for i = 1:n
    if maxStress.s10 < meshConvergence.s10(i,2)
        maxStress.s10 = meshConvergence.s10(i,2);
    end
end

meshConvergence.s08 = [0	0
0.00122323	81.9082
0.00152866	102.36
0.00249423	122.205
0.00286378	122.872
0.00317895	123.383
0.00371492	124.116
0.0044763	125.004
0.00574834	125.949
0.00742988	126.885
0.01018	127.881
0.0150709	128.69
0.0154514	128.742
0.0158112	128.79
0.016108	128.827
0.0165279	128.873
0.0166802	128.89
0.016739	128.897
0.0168354	128.908
0.0172179	128.814
0.0174351	128.762
0.0175118	128.743
0.0176716	128.705
0.0177347	128.69
0.017836	128.665
0.0180426	128.616
0.0186633	128.467
0.0195219	128.261
0.0204953	128.026
0.0220092	127.66
0.0243234	127.098
0.0279345	126.213
0.0335528	124.82
0.0427925	122.481
0.0574631	118.648
0.0815172	112.019
0.0907568	109.363
0.105319	105.034
0.129631	97.3696
0.179486	79.1024
0.192342	73.9313
0.205762	68.2793
0.226647	58.9484
0.258314	43.6797
0.305373	18.6782
0.322716	8.61404
0.34782	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
];

n = numel(meshConvergence.s08(:,2));
maxStress.s08 = 0;
for i = 1:n
    if maxStress.s08 < meshConvergence.s08(i,2)
        maxStress.s08 = meshConvergence.s08(i,2);
    end
end

meshConvergence.s05 = [0	0
0.00122594	82.1323
0.00153209	102.645
0.00247423	122.154
0.00283293	122.809
0.00314736	123.337
0.00365913	124.053
0.00440447	124.919
0.00563433	125.866
0.00728057	126.827
0.00998982	127.827
0.0148697	128.663
0.0152788	128.718
0.0156458	128.768
0.0159878	128.814
0.0164571	128.866
0.0166275	128.885
0.0166912	128.892
0.0167858	128.902
0.0172273	128.795
0.0174344	128.746
0.0175543	128.718
0.0178414	128.65
0.0194267	128.276
0.0213722	127.815
0.0234599	127.317
0.0268198	126.51
0.0322955	125.177
0.0415682	122.874
0.0571728	118.857
0.0849249	111.217
0.142238	92.6201
0.165435	84.0914
0.202775	68.8744
0.259624	42.4371
0.344305	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
];

n = numel(meshConvergence.s05(:,2));
maxStress.s05 = 0;
for i = 1:n
    if maxStress.s05 < meshConvergence.s05(i,2)
        maxStress.s05 = meshConvergence.s05(i,2);
    end
end

meshConvergence.s03 = [0	0
0.00122305	81.895
0.00152847	102.348
0.00248784	122.188
0.00286069	122.866
0.0031792	123.383
0.00371499	124.116
0.00447342	125
0.00574819	125.949
0.00744195	126.889
0.0101852	127.882
0.015104	128.695
0.0154903	128.747
0.0158481	128.795
0.0161555	128.832
0.0165798	128.879
0.0167347	128.896
0.0167925	128.903
0.0168783	128.912
0.0169107	128.916
0.0169919	128.896
0.0171707	128.855
0.0172741	128.831
0.0173184	128.82
0.017394	128.803
0.0176556	128.742
0.0203355	128.117
0.0234708	127.38
0.0269421	126.558
0.0327227	125.168
0.0426476	122.729
0.0466372	121.729
0.0531634	120.069
0.0600885	118.274
0.067382	116.343
0.0791528	113.135
0.098779	107.503
0.133815	96.3825
0.199872	70.9954
0.225824	59.656
0.268024	39.459
0.28457	30.9692
0.311684	16.2334
0.32244	10.0624
0.340613	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
];

n = numel(meshConvergence.s03(:,2));
maxStress.s03 = 0;
for i = 1:n
    if maxStress.s03 < meshConvergence.s03(i,2)
        maxStress.s03 = meshConvergence.s03(i,2);
    end
end

meshConvergence.s02 = [0	0
0.00122608	82.1452
0.00153227	102.661
0.00247236	122.15
0.00282887	122.801
0.00314359	123.332
0.00347871	123.828
0.00400484	124.449
0.00470977	125.217
0.00595244	126.099
0.00762629	126.967
0.010258	127.901
0.0152428	128.714
0.0156212	128.765
0.0159629	128.811
0.0162873	128.847
0.0167329	128.896
0.0167779	128.901
0.0168396	128.908
0.0170202	128.864
0.017255	128.809
0.0173595	128.784
0.0176592	128.714
0.0177974	128.681
0.0182035	128.586
0.019435	128.296
0.0214814	127.813
0.0238077	127.26
0.0263063	126.663
0.0303838	125.679
0.0371404	124.024
0.0500091	120.785
0.0653481	116.774
0.0831706	111.892
0.117217	101.752
0.131436	97.2055
0.156565	88.5501
0.205829	68.9863
0.226247	60.0074
0.263978	41.9639
0.280257	33.6331
0.286837	30.1697
0.29837	23.9685
0.303022	21.42
0.311089	16.8895
0.329681	6.15596
0.338417	1.12986
0.367391	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
];

n = numel(meshConvergence.s02(:,2));
maxStress.s02 = 0;
for i = 1:n
    if maxStress.s02 < meshConvergence.s02(i,2)
        maxStress.s02 = meshConvergence.s02(i,2);
    end
end

elSizes = [216
    770
    3080
    4752
    12364
    35100
    78030
    ];
convergenceCrit = [
    maxStress.s40
    maxStress.s20
    maxStress.s10
    maxStress.s08
    maxStress.s05
    maxStress.s03
    maxStress.s02
    ];
%x = linspace(1,numel(convergenceCrit),numel(convergenceCrit));
%y = convergenceCrit;
%scatter(x,y)
%b = num2str(elSizes); c = cellstr(b);
%dx = 0.005; dy = 0.005; % displacement so the text does not overlay the data points
%text(x+dx, y+dy, c);
%grid on

%data from analysis
%tabular damage
stressTabularDamage = [0	0
0.00123111	82.5792
0.00153864	103.208
0.00238589	121.94
0.00267684	122.587
0.00298152	123.09
0.00342179	123.744
0.00409984	124.56
0.005125	125.535
0.00663779	126.508
0.00912675	127.516
0.0136133	128.495
0.0197733	129.284
0.0255355	130.03
0.0311207	130.757
0.039063	131.796
0.0428833	132.244
0.0476886	132.801
0.0526647	133.221
0.0564824	133.582
0.0599507	133.878
0.0607276	133.986
0.0618209	134.074
0.0630742	134.124
0.0651239	134.304
0.0688885	134.573
0.0746401	134.964
0.0850498	135.734
0.1035	137.023
0.111943	137.579
0.126551	138.532
0.131956	138.928
0.14275	139.577
0.162494	140.885
0.170273	141.35
0.181954	142.229
0.202312	143.538
0.223695	144.873
0.246993	146.072
0.288279	146.564
0.29943	146.014
0.311666	144.988
0.333099	142.239
0.342351	139.126
0.359754	131.333
0.367022	126.661
0.379271	117.388
0.399329	98.7588
0.43797	30.2514
0.454015	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
];

s22data = [0	0
0.00121664	82.088
0.00152037	102.58
0.00249001	122.841
0.00287714	123.437
0.00319872	123.896
0.00375624	124.64
0.00454231	125.493
0.00585528	126.368
0.00764983	127.346
0.010462	128.326
0.0153092	129.109
0.018441	129.494
0.0214406	129.968
0.0246076	130.457
0.0255203	130.584
0.0256003	130.589
0.0256751	130.61
0.0256756	130.656
0.0256751	130.608
0.0260818	130.761
0.0265805	130.862
0.0270388	130.957
0.0276591	131.057
0.0284824	131.177
0.0295704	131.35
0.0309053	131.564
0.0324555	131.795
0.0340343	131.968
0.0352548	132.097
0.0359114	132.072
0.0360593	132.008
0.0375172	132.451
0.0390049	132.744
0.0405839	132.955
0.0426138	133.326
0.0460175	133.7
0.0505084	134.226
0.0565843	134.907
0.0661876	135.855
0.080481	137.259
0.0860483	137.683
0.0944059	138.413
0.107286	139.336
0.112519	139.423
0.118203	140.081
0.124305	140.862
0.133722	141.879
0.147978	143.266
0.17002	145.388
0.205471	148.18
0.245589	149.338
0.256029	148.825
0.273465	147.221
0.280595	146.225
0.293287	143.093
0.298637	140.763
0.308049	134.668
0.324968	117.639
0.331915	105.639
0.343981	75.6593
0.364792	16.349
0.392509	0.00204492
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
];

mises = [0	0
0.00121664	81.3761
0.00152037	101.692
0.00249001	122.184
0.00287714	122.893
0.00319872	123.407
0.00375624	124.159
0.00454231	125.077
0.00585528	126.025
0.00764983	126.976
0.010462	127.953
0.0153092	128.722
0.018441	129.112
0.0214406	129.499
0.0246076	129.909
0.0255203	130.028
0.0256003	130.038
0.0256751	130.048
0.0256756	130.048
0.0256751	130.026
0.0260818	130.1
0.0265805	130.165
0.0270388	130.225
0.0276591	130.305
0.0284824	130.412
0.0295704	130.554
0.0309053	130.728
0.0324555	130.93
0.0340343	131.137
0.0352548	131.263
0.0359114	131.306
0.0360593	131.331
0.0375172	131.544
0.0390049	131.729
0.0405839	131.826
0.0426138	132.094
0.0460175	132.318
0.0505084	132.64
0.0565843	133.123
0.0661876	133.655
0.080481	134.479
0.0860483	134.701
0.0944059	135.137
0.107286	135.746
0.112519	136.005
0.118203	136.241
0.124305	136.536
0.133722	136.975
0.147978	137.663
0.17002	138.773
0.205471	139.846
0.245589	138.29
0.256029	136.905
0.273465	133.679
0.280595	131.839
0.293287	127.168
0.298637	124.249
0.308049	117.653
0.324968	102.018
0.331915	91.5269
0.343981	65.5269
0.364792	14.1598
0.392509	0.00177123
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
0	0
];

plot(s22data(:,1),s22data(:,2))
grid on
xlabel('LE22 Strain')
ylabel('S22 Stress/MPa')
title('Graph to show S22 stress at point of failure')
ylim([0,170])